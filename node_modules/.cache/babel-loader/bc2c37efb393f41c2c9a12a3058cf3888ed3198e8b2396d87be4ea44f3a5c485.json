{"ast":null,"code":"// src/components/Reports/ShareReport.jsx\nimport React,{useState,useEffect}from'react';import{reportsAPI}from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShareReport=_ref=>{let{reportId,reportName,onClose}=_ref;const[email,setEmail]=useState('');const[sharedUsers,setSharedUsers]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const[success,setSuccess]=useState('');useEffect(()=>{fetchSharedUsers();},[reportId]);const fetchSharedUsers=async()=>{try{const response=await reportsAPI.getSharedWith(reportId);setSharedUsers(response.data);}catch(err){console.error('Failed to fetch shared users:',err);}};const handleShare=async e=>{e.preventDefault();setLoading(true);setError('');setSuccess('');try{await reportsAPI.share(reportId,{shared_with_email:email,access_type:'read'});setSuccess('Report shared successfully!');setEmail('');fetchSharedUsers();}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||'Failed to share report');}finally{setLoading(false);}};const handleRevoke=async userId=>{if(window.confirm('Are you sure you want to revoke access?')){try{await reportsAPI.revokeAccess(reportId,userId);setSuccess('Access revoked successfully');fetchSharedUsers();}catch(err){setError('Failed to revoke access');}}};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Share Report\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:onClose,children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"report-name-display\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Report:\"}),\" \",reportName]}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleShare,className:\"share-form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Share with Email\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-button-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Enter email address\",value:email,onChange:e=>setEmail(e.target.value),required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:loading,children:loading?'Sharing...':'Share'})]})]})}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),success&&/*#__PURE__*/_jsx(\"div\",{className:\"success-message\",children:success}),/*#__PURE__*/_jsxs(\"div\",{className:\"shared-users-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Shared With (\",sharedUsers.length,\")\"]}),sharedUsers.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"shared-users-list\",children:sharedUsers.map(user=>/*#__PURE__*/_jsxs(\"div\",{className:\"shared-user-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:user.username}),/*#__PURE__*/_jsx(\"span\",{className:\"user-email\",children:user.email}),/*#__PURE__*/_jsxs(\"span\",{className:\"share-date\",children:[\"Shared: \",new Date(user.shared_at).toLocaleDateString()]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-danger small\",onClick:()=>handleRevoke(user.id),children:\"Revoke\"})]},user.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"no-data\",children:\"Not shared with anyone yet\"})]})]})]})});};export default ShareReport;","map":{"version":3,"names":["React","useState","useEffect","reportsAPI","jsx","_jsx","jsxs","_jsxs","ShareReport","_ref","reportId","reportName","onClose","email","setEmail","sharedUsers","setSharedUsers","loading","setLoading","error","setError","success","setSuccess","fetchSharedUsers","response","getSharedWith","data","err","console","handleShare","e","preventDefault","share","shared_with_email","access_type","_err$response","_err$response$data","handleRevoke","userId","window","confirm","revokeAccess","className","onClick","children","stopPropagation","onSubmit","type","placeholder","value","onChange","target","required","disabled","length","map","user","username","Date","shared_at","toLocaleDateString","id"],"sources":["D:/MERN STACK PROJECT/FRONTEND/HEALTH_WALLET_FRONTEND/src/components/Reports/ShareReport.jsx"],"sourcesContent":["// src/components/Reports/ShareReport.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { reportsAPI } from '../../services/api';\r\n\r\nconst ShareReport = ({ reportId, reportName, onClose }) => {\r\n  const [email, setEmail] = useState('');\r\n  const [sharedUsers, setSharedUsers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n\r\n  useEffect(() => {\r\n    fetchSharedUsers();\r\n  }, [reportId]);\r\n\r\n  const fetchSharedUsers = async () => {\r\n    try {\r\n      const response = await reportsAPI.getSharedWith(reportId);\r\n      setSharedUsers(response.data);\r\n    } catch (err) {\r\n      console.error('Failed to fetch shared users:', err);\r\n    }\r\n  };\r\n\r\n  const handleShare = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    try {\r\n      await reportsAPI.share(reportId, {\r\n        shared_with_email: email,\r\n        access_type: 'read'\r\n      });\r\n      setSuccess('Report shared successfully!');\r\n      setEmail('');\r\n      fetchSharedUsers();\r\n    } catch (err) {\r\n      setError(err.response?.data?.error || 'Failed to share report');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRevoke = async (userId) => {\r\n    if (window.confirm('Are you sure you want to revoke access?')) {\r\n      try {\r\n        await reportsAPI.revokeAccess(reportId, userId);\r\n        setSuccess('Access revoked successfully');\r\n        fetchSharedUsers();\r\n      } catch (err) {\r\n        setError('Failed to revoke access');\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"modal-overlay\" onClick={onClose}>\r\n      <div className=\"modal-content\" onClick={(e) => e.stopPropagation()}>\r\n        <div className=\"modal-header\">\r\n          <h2>Share Report</h2>\r\n          <button className=\"close-btn\" onClick={onClose}>âœ•</button>\r\n        </div>\r\n\r\n        <div className=\"modal-body\">\r\n          <p className=\"report-name-display\">\r\n            <strong>Report:</strong> {reportName}\r\n          </p>\r\n\r\n          <form onSubmit={handleShare} className=\"share-form\">\r\n            <div className=\"form-group\">\r\n              <label>Share with Email</label>\r\n              <div className=\"input-button-group\">\r\n                <input\r\n                  type=\"email\"\r\n                  placeholder=\"Enter email address\"\r\n                  value={email}\r\n                  onChange={(e) => setEmail(e.target.value)}\r\n                  required\r\n                />\r\n                <button \r\n                  type=\"submit\" \r\n                  className=\"btn-primary\"\r\n                  disabled={loading}\r\n                >\r\n                  {loading ? 'Sharing...' : 'Share'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </form>\r\n\r\n          {error && <div className=\"error-message\">{error}</div>}\r\n          {success && <div className=\"success-message\">{success}</div>}\r\n\r\n          <div className=\"shared-users-section\">\r\n            <h3>Shared With ({sharedUsers.length})</h3>\r\n            {sharedUsers.length > 0 ? (\r\n              <div className=\"shared-users-list\">\r\n                {sharedUsers.map((user) => (\r\n                  <div key={user.id} className=\"shared-user-item\">\r\n                    <div className=\"user-info\">\r\n                      <strong>{user.username}</strong>\r\n                      <span className=\"user-email\">{user.email}</span>\r\n                      <span className=\"share-date\">\r\n                        Shared: {new Date(user.shared_at).toLocaleDateString()}\r\n                      </span>\r\n                    </div>\r\n                    <button\r\n                      className=\"btn-danger small\"\r\n                      onClick={() => handleRevoke(user.id)}\r\n                    >\r\n                      Revoke\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <p className=\"no-data\">Not shared with anyone yet</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShareReport;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}